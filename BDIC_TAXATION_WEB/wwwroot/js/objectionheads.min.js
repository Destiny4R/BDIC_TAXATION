function sendMessageAction(n,t){if(n===""||t===""||t===null||t===" ")return Swal.fire({icon:"error",text:"Remark is required!",footer:"Validation"});$.ajax({type:"POST",url:"/v1/ResolvedObjectionAdmin",data:{id:n,remark:t},success:function(n){$.unblockUI();n.success?(swal.fire("Action Result!",n.message,"success"),table.ajax.reload(null,!1)):Swal.fire({icon:"error",title:"Oops...",text:n.message,footer:"Message"})},beforeSend:function(){blockcallback()},error:function(){$.unblockUI();Swal.fire({icon:"error",title:"Oops...",text:"Something went wrong!",footer:"Check internet connectivity"})},complete:function(){$.unblockUI()}})}function blockcallback(){$.blockUI({message:'<div class="bs-spinner mt-4 mt-lg-0"><div class= "spinner-border text-success mr-2 mt-2" style="width: 10rem; height: 10rem;" role="status"><span class="sr-only">Loading...<\/span><\/div> ',fadeIn:800,overlayCSS:{backgroundColor:"#1b2024",opacity:.8,zIndex:1200,cursor:"wait"},css:{border:0,color:"#fff",zIndex:1201,padding:0,backgroundColor:"transparent"},onBlock:function(){}})}function getSwitchLabel(n){switch(n){case"0":return'<span class="badge badge-warning">Under review<\/span>';case"1":return'<span class="badge bg-info">In Progress<\/span>';case"2":return'<span class="badge bg-success">Resolved<\/span>';case"3":return'<span class="badge bg-danger opacity-75">Closed<\/span>';default:return'<span class="badge bg-dark">N/A<\/span>'}}var table=null;$(document).ready(function(){table=$("#objectionTable").DataTable({serverSide:!0,processing:!0,searching:!0,paging:!0,info:!0,responsive:!0,ajax:{url:"/view/taxObjectionsheads",type:"POST",dataType:"json"},columns:[{data:null,orderable:!1,searchable:!1,autoWidth:!0,render:function(n,t,i,r){return r.settings._iDisplayStart+r.row+1}},{data:"name",autoWidth:!0},{data:"reference",autoWidth:!0},{data:"payerid",autoWidth:!0},{data:"session",autoWidth:!0},{data:"taxamount",autoWidth:!0},{data:"createdate",autoWidth:!0,render:function(n){if(n!=null){var t=new Date(n).getHours();let i=t>=12?"pm":"am";return n=n.toLocaleString("YYYY-MM-dd").slice(0,19).replace("T"," ")+" "+i}return"null"}},{data:"objectiontype",autoWidth:!0,render:function(n){switch(n){case"0":return'<span class="badge badge-warning">Under review<\/span>';case"1":return'<span class="badge bg-info"><i class="fas fa - spinner"><\/i> In Progress<\/span>';case"2":return'<span class="badge bg-success badge-status"><i class="fas fa-check-double"><\/i> Resolved<\/span>';case"3":return'<span class="badge bg-danger opacity-75"><i class="far fa-times-circle"><\/i> Closed<\/span>';default:return'<span class="badge bg-dark">N/A<\/span>'}}},{data:null,orderable:!1,render:function(n,t,i){const u=document.createElement("div");u.className="dropdown";const r=document.createElement("button");r.type="button";r.className="btn btn-sm btn-light ";r.setAttribute("data-bs-toggle","dropdown");r.setAttribute("aria-expanded","false");const e=document.createElement("i");e.className="mdi mdi-dots-horizontal";r.appendChild(e);const f=document.createElement("ul");f.className="dropdown-menu";const o=[{text:"View",icon:"mdi-eye-circle-outline",className:"btn-outline-secondary viewdetail-btn",attributes:{"data-id":i.id,href:"#"}},{text:"Resolve",className:"btn-outline-success btn-resolved-obj",attributes:{"data-id":i.id,href:"#"}},{text:"Reject",className:"btn-outline-danger btn-reject-obj",attributes:{"data-id":i.id,href:"#"}}];return o.forEach(n=>{const i=document.createElement("li"),t=document.createElement("a");if(t.className=`dropdown-item btn btn-sm rounded ${n.className}`,Object.entries(n.attributes).forEach(([n,i])=>{t.setAttribute(n,i)}),n.icon){const i=document.createElement("i");i.className=`mdi ${n.icon}`;t.appendChild(i);t.appendChild(document.createTextNode(" "+n.text))}else t.textContent=n.text;i.appendChild(t);f.appendChild(i)}),u.appendChild(r),u.appendChild(f),u.outerHTML}}],language:{processing:'<div class="spinner-border text-success" style="width: 8rem; height: 8rem;" role="status"><span class="visually-hidden">Loading...<\/span><\/div>',lengthMenu:"Show _MENU_ entries",zeroRecords:"No matching records found",info:"Showing _START_ to _END_ of _TOTAL_ entries",infoEmpty:"Showing 0 to 0 of 0 entries",infoFiltered:"(filtered from _MAX_ total entries)",search:"Search:",paginate:{first:'<i class="fas fa-angle-left"><\/i>',last:'<i class="fas fa-angle-right"><\/i>',next:"Next",previous:"Prev"}},initComplete:function(){console.log("Table initialized")}})});$(document).on("click",".viewdetail-btn",function(){const n=$(this).data("id");$.ajax({type:"POST",url:"/v1/GetObjectionDetailsIndividual/"+n,success:function(n){var t,i;if($.unblockUI(),n.success){t=n.data;$("#income").text(t.income);$("#name").text(t.name);$("#session").text(t.session);$("#payerid").text(t.payerid);$("#reference").text(t.reference);$("#objectiontype").text(t.objectiontype);$("#message").text(t.message);$("#taxamount").text(t.taxamount);$("#status").text(t.status);$("#taxamount").text(t.id);i=new Date(t.createddate).getHours();let e=i>=12?"pm":"am",l=t.createdate.toLocaleString("YYYY-MM-dd").slice(0,19).replace("T"," ")+" "+e;const o=$("#labeliconDiv").empty();o.append(getSwitchLabel(t.objectiontype));let s=`<div class="col-8">
                                <i class="bi bi-file-earmark-pdf fs-1 text-danger"></i>
                                <p class="small mb-1">${t.filename}</p>
                            </div>
                            <a class="btn btn-sm btn-light col-4" target="_blank" href="${t.filepath}"><i class="dripicons-download"></i></a>`;const h=$("#downloadContainer").empty();h.append(s);const f=document.getElementById("btn-Div");$("#btn-Div").empty();const r=document.createElement("button");r.type="button";r.dataset.id=t.id;r.className="btn btn-success w-100 btn-resolve";r.textContent="Resolve";const u=document.createElement("button");u.type="button";u.dataset.id=t.id;u.className="btn btn-outline-danger w-100 btn-reject";u.textContent="Reject Observation";f.appendChild(r);f.appendChild(u);const c=new bootstrap.Modal("#objectionDetailModal");c.show()}else Swal.fire({icon:"error",title:"Oops...",text:n.message,footer:"Message"})},beforeSend:function(){blockcallback()},error:function(){$.unblockUI();Swal.fire({icon:"error",title:"Oops...",text:"Something went wrong!",footer:"Check internet connectivity"})},complete:function(){$.unblockUI()}})});$(document).on("click",".btn-resolved-obj",function(){const n=$(this).data("id");$("#resoiveid").val(n);const t=new bootstrap.Modal("#resolveremarkModal");t.show()});$(document).on("click",".btn-reject-obj",function(){const n=$(this).data("id");$("#resoiveid").val(n);const t=new bootstrap.Modal("#rejectremarkModal");t.show()});$(document).on("click",".btn-submitresolve",function(){let n=$("#resoiveid").val(),t=$("#remark").val();sendMessageAction(n,t)});$(document).on("click",".btn-rejectaction",function(){let n=$("#resoiveid").val(),t=$("#disabledTextInput").val();sendMessageAction(n,t)});$(document).on("click",".btn-close",function(){setTimeout(()=>{$("body").removeClass("modal-open"),$(".modal-backdrop").remove(),view.show()},500)});